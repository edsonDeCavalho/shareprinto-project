// Translations object
const translations = {
    en: {
        // Navigation
        navHome: "Home",
        navHowItWorks: "How It Works",
        navBenefits: "Benefits",
        navGetStarted: "Get Started",
        
        // Hero Section
        heroTitle: "Connect. Print. Share.",
        heroSubtitle: "The future of 3D printing is peer-to-peer. Join the community that's revolutionizing how we create and manufacture.",
        btnGetStarted: "Get Started",
        btnLearnMore: "Learn More",
        
        // How It Works
        howItWorksTitle: "How It Works",
        step1Title: "Upload Your Design",
        step1Desc: "Share your 3D model file (STL, OBJ, etc.) and specify your printing requirements.",
        step2Title: "Find Local Printers",
        step2Desc: "Our platform connects you with nearby 3D printer owners who can bring your design to life.",
        step3Title: "Receive Offers",
        step3Desc: "Get competitive offers from multiple printers. Compare prices, materials, and delivery times.",
        step4Title: "Print & Deliver",
        step4Desc: "Choose your preferred printer, and receive your finished product delivered to your door.",
        
        // Benefits
        benefitsTitle: "Why Choose SharePrinto?",
        benefit1Title: "Cost-Effective",
        benefit1Desc: "Access 3D printing services without investing in expensive equipment. Pay only for what you need.",
        benefit2Title: "Local & Sustainable",
        benefit2Desc: "Support local makers and reduce shipping distances. Print closer to home, faster and greener.",
        benefit3Title: "Fast Turnaround",
        benefit3Desc: "Find printers in your area for quick delivery. No more waiting weeks for your prints.",
        benefit4Title: "Material Variety",
        benefit4Desc: "Choose from a wide range of materials and colors. Each printer offers different options.",
        benefit5Title: "Community Driven",
        benefit5Desc: "Join a network of creators and makers. Build relationships with local 3D printing enthusiasts.",
        benefit6Title: "Secure & Trusted",
        benefit6Desc: "Safe transactions, verified printers, and quality guarantees. Your satisfaction is our priority.",
        
        // Get Started
        getStartedTitle: "Ready to Start Printing?",
        getStartedSubtitle: "Join thousands of creators and makers who are already using SharePrinto to bring their ideas to life.",
        btnCreateAccount: "Create an Account",
        btnBecomePrinter: "Become a Printer",
        ctaNote: "Free to join. Start printing today.",
        
        // Footer
        footerTagline: "Connecting creators with 3D printers worldwide.",
        footerQuickLinks: "Quick Links",
        footerContact: "Contact",
        footerRights: "All rights reserved."
    },
    fr: {
        // Navigation
        navHome: "Accueil",
        navHowItWorks: "Comment ça marche",
        navBenefits: "Avantages",
        navGetStarted: "Commencer",
        
        // Hero Section
        heroTitle: "Connectez. Imprimez. Partagez.",
        heroSubtitle: "L'avenir de l'impression 3D est le pair-à-pair. Rejoignez la communauté qui révolutionne la façon dont nous créons et fabriquons.",
        btnGetStarted: "Commencer",
        btnLearnMore: "En savoir plus",
        
        // How It Works
        howItWorksTitle: "Comment ça marche",
        step1Title: "Téléchargez votre design",
        step1Desc: "Partagez votre fichier de modèle 3D (STL, OBJ, etc.) et spécifiez vos exigences d'impression.",
        step2Title: "Trouvez des imprimantes locales",
        step2Desc: "Notre plateforme vous connecte avec des propriétaires d'imprimantes 3D à proximité qui peuvent donner vie à votre design.",
        step3Title: "Recevez des offres",
        step3Desc: "Obtenez des offres compétitives de plusieurs imprimantes. Comparez les prix, les matériaux et les délais de livraison.",
        step4Title: "Imprimez et livrez",
        step4Desc: "Choisissez votre imprimante préférée et recevez votre produit fini livré à votre porte.",
        
        // Benefits
        benefitsTitle: "Pourquoi choisir SharePrinto ?",
        benefit1Title: "Économique",
        benefit1Desc: "Accédez aux services d'impression 3D sans investir dans un équipement coûteux. Payez uniquement ce dont vous avez besoin.",
        benefit2Title: "Local et durable",
        benefit2Desc: "Soutenez les créateurs locaux et réduisez les distances d'expédition. Imprimez plus près de chez vous, plus rapidement et plus écologiquement.",
        benefit3Title: "Délais rapides",
        benefit3Desc: "Trouvez des imprimantes dans votre région pour une livraison rapide. Plus besoin d'attendre des semaines pour vos impressions.",
        benefit4Title: "Variété de matériaux",
        benefit4Desc: "Choisissez parmi une large gamme de matériaux et de couleurs. Chaque imprimante offre différentes options.",
        benefit5Title: "Communauté",
        benefit5Desc: "Rejoignez un réseau de créateurs et de fabricants. Établissez des relations avec des passionnés d'impression 3D locaux.",
        benefit6Title: "Sécurisé et fiable",
        benefit6Desc: "Transactions sécurisées, imprimantes vérifiées et garanties de qualité. Votre satisfaction est notre priorité.",
        
        // Get Started
        getStartedTitle: "Prêt à commencer à imprimer ?",
        getStartedSubtitle: "Rejoignez des milliers de créateurs et de fabricants qui utilisent déjà SharePrinto pour donner vie à leurs idées.",
        btnCreateAccount: "Créer un compte",
        btnBecomePrinter: "Devenir imprimeur",
        ctaNote: "Gratuit pour rejoindre. Commencez à imprimer aujourd'hui.",
        
        // Footer
        footerTagline: "Connecter les créateurs avec des imprimantes 3D dans le monde entier.",
        footerQuickLinks: "Liens rapides",
        footerContact: "Contact",
        footerRights: "Tous droits réservés."
    },
    es: {
        // Navigation
        navHome: "Inicio",
        navHowItWorks: "Cómo funciona",
        navBenefits: "Beneficios",
        navGetStarted: "Comenzar",
        
        // Hero Section
        heroTitle: "Conecta. Imprime. Comparte.",
        heroSubtitle: "El futuro de la impresión 3D es peer-to-peer. Únete a la comunidad que está revolucionando cómo creamos y fabricamos.",
        btnGetStarted: "Comenzar",
        btnLearnMore: "Saber más",
        
        // How It Works
        howItWorksTitle: "Cómo funciona",
        step1Title: "Sube tu diseño",
        step1Desc: "Comparte tu archivo de modelo 3D (STL, OBJ, etc.) y especifica tus requisitos de impresión.",
        step2Title: "Encuentra impresoras locales",
        step2Desc: "Nuestra plataforma te conecta con propietarios de impresoras 3D cercanos que pueden dar vida a tu diseño.",
        step3Title: "Recibe ofertas",
        step3Desc: "Obtén ofertas competitivas de múltiples impresoras. Compara precios, materiales y tiempos de entrega.",
        step4Title: "Imprime y entrega",
        step4Desc: "Elige tu impresora preferida y recibe tu producto terminado entregado en tu puerta.",
        
        // Benefits
        benefitsTitle: "¿Por qué elegir SharePrinto?",
        benefit1Title: "Económico",
        benefit1Desc: "Accede a servicios de impresión 3D sin invertir en equipos costosos. Paga solo por lo que necesitas.",
        benefit2Title: "Local y sostenible",
        benefit2Desc: "Apoya a los creadores locales y reduce las distancias de envío. Imprime más cerca de casa, más rápido y más ecológico.",
        benefit3Title: "Entrega rápida",
        benefit3Desc: "Encuentra impresoras en tu área para entrega rápida. No más esperar semanas por tus impresiones.",
        benefit4Title: "Variedad de materiales",
        benefit4Desc: "Elige entre una amplia gama de materiales y colores. Cada impresora ofrece diferentes opciones.",
        benefit5Title: "Impulsado por la comunidad",
        benefit5Desc: "Únete a una red de creadores y fabricantes. Construye relaciones con entusiastas locales de impresión 3D.",
        benefit6Title: "Seguro y confiable",
        benefit6Desc: "Transacciones seguras, impresoras verificadas y garantías de calidad. Tu satisfacción es nuestra prioridad.",
        
        // Get Started
        getStartedTitle: "¿Listo para empezar a imprimir?",
        getStartedSubtitle: "Únete a miles de creadores y fabricantes que ya están usando SharePrinto para dar vida a sus ideas.",
        btnCreateAccount: "Crear una cuenta",
        btnBecomePrinter: "Convertirse en impresor",
        ctaNote: "Gratis para unirse. Comienza a imprimir hoy.",
        
        // Footer
        footerTagline: "Conectando creadores con impresoras 3D en todo el mundo.",
        footerQuickLinks: "Enlaces rápidos",
        footerContact: "Contacto",
        footerRights: "Todos los derechos reservados."
    },
    de: {
        // Navigation
        navHome: "Startseite",
        navHowItWorks: "Wie es funktioniert",
        navBenefits: "Vorteile",
        navGetStarted: "Loslegen",
        
        // Hero Section
        heroTitle: "Verbinden. Drucken. Teilen.",
        heroSubtitle: "Die Zukunft des 3D-Drucks ist Peer-to-Peer. Werden Sie Teil der Gemeinschaft, die revolutioniert, wie wir erstellen und herstellen.",
        btnGetStarted: "Loslegen",
        btnLearnMore: "Mehr erfahren",
        
        // How It Works
        howItWorksTitle: "Wie es funktioniert",
        step1Title: "Design hochladen",
        step1Desc: "Teilen Sie Ihre 3D-Modelldatei (STL, OBJ, etc.) und geben Sie Ihre Druckanforderungen an.",
        step2Title: "Lokale Drucker finden",
        step2Desc: "Unsere Plattform verbindet Sie mit nahegelegenen 3D-Druckerbesitzern, die Ihr Design zum Leben erwecken können.",
        step3Title: "Angebote erhalten",
        step3Desc: "Erhalten Sie wettbewerbsfähige Angebote von mehreren Druckern. Vergleichen Sie Preise, Materialien und Lieferzeiten.",
        step4Title: "Drucken und liefern",
        step4Desc: "Wählen Sie Ihren bevorzugten Drucker und erhalten Sie Ihr fertiges Produkt direkt an Ihre Tür geliefert.",
        
        // Benefits
        benefitsTitle: "Warum SharePrinto wählen?",
        benefit1Title: "Kosteneffektiv",
        benefit1Desc: "Zugang zu 3D-Druckdiensten ohne Investition in teure Ausrüstung. Zahlen Sie nur für das, was Sie brauchen.",
        benefit2Title: "Lokal und nachhaltig",
        benefit2Desc: "Unterstützen Sie lokale Hersteller und reduzieren Sie Versanddistanzen. Drucken Sie näher zu Hause, schneller und umweltfreundlicher.",
        benefit3Title: "Schnelle Bearbeitung",
        benefit3Desc: "Finden Sie Drucker in Ihrer Nähe für schnelle Lieferung. Keine wochenlangen Wartezeiten mehr für Ihre Drucke.",
        benefit4Title: "Materialvielfalt",
        benefit4Desc: "Wählen Sie aus einer Vielzahl von Materialien und Farben. Jeder Drucker bietet verschiedene Optionen.",
        benefit5Title: "Gemeinschaftsgetrieben",
        benefit5Desc: "Werden Sie Teil eines Netzwerks von Schöpfern und Herstellern. Bauen Sie Beziehungen zu lokalen 3D-Druck-Enthusiasten auf.",
        benefit6Title: "Sicher und vertrauenswürdig",
        benefit6Desc: "Sichere Transaktionen, verifizierte Drucker und Qualitätsgarantien. Ihre Zufriedenheit ist unsere Priorität.",
        
        // Get Started
        getStartedTitle: "Bereit zum Drucken?",
        getStartedSubtitle: "Werden Sie Teil von Tausenden von Schöpfern und Herstellern, die SharePrinto bereits nutzen, um ihre Ideen zum Leben zu erwecken.",
        btnCreateAccount: "Konto erstellen",
        btnBecomePrinter: "Drucker werden",
        ctaNote: "Kostenlos beizutreten. Beginnen Sie noch heute mit dem Drucken.",
        
        // Footer
        footerTagline: "Schöpfer weltweit mit 3D-Druckern verbinden.",
        footerQuickLinks: "Schnelllinks",
        footerContact: "Kontakt",
        footerRights: "Alle Rechte vorbehalten."
    }
};

// Country to language mapping
const countryToLanguage = {
    // French-speaking countries
    'FR': 'fr', 'BE': 'fr', 'CH': 'fr', 'LU': 'fr', 'MC': 'fr', 'CA': 'fr',
    // Spanish-speaking countries
    'ES': 'es', 'MX': 'es', 'AR': 'es', 'CO': 'es', 'CL': 'es', 'PE': 'es',
    'VE': 'es', 'EC': 'es', 'GT': 'es', 'CU': 'es', 'BO': 'es', 'DO': 'es',
    'HN': 'es', 'PY': 'es', 'SV': 'es', 'NI': 'es', 'CR': 'es', 'PA': 'es',
    'UY': 'es', 'PR': 'es',
    // German-speaking countries
    'DE': 'de', 'AT': 'de', 'LI': 'de',
    // Default to English for other countries
};

// Browser language to our language code mapping
const browserLangToCode = {
    'fr': 'fr', 'fr-FR': 'fr', 'fr-BE': 'fr', 'fr-CH': 'fr', 'fr-CA': 'fr',
    'es': 'es', 'es-ES': 'es', 'es-MX': 'es', 'es-AR': 'es', 'es-CO': 'es',
    'de': 'de', 'de-DE': 'de', 'de-AT': 'de', 'de-CH': 'de',
};

// Detect language from browser
function detectBrowserLanguage() {
    const browserLang = navigator.language || navigator.userLanguage;
    const langCode = browserLang.split('-')[0].toLowerCase();
    
    // Check full language code first
    if (browserLangToCode[browserLang]) {
        return browserLangToCode[browserLang];
    }
    
    // Check language code only
    if (browserLangToCode[langCode]) {
        return browserLangToCode[langCode];
    }
    
    return 'en'; // Default to English
}

// Detect country and return appropriate language
async function detectCountryAndLanguage() {
    // First, check if user has manually selected a language
    const manualLanguage = localStorage.getItem('language');
    if (manualLanguage) {
        return manualLanguage;
    }
    
    // Try to detect country via IP geolocation
    try {
        // Using ipapi.co free API (no API key required for basic usage)
        const response = await fetch('https://ipapi.co/json/', {
            method: 'GET',
            headers: {
                'Accept': 'application/json',
            },
        });
        
        if (response.ok) {
            const data = await response.json();
            const countryCode = data.country_code;
            
            if (countryCode && countryToLanguage[countryCode]) {
                return countryToLanguage[countryCode];
            }
        }
    } catch (error) {
        console.log('Country detection failed, using browser language:', error);
    }
    
    // Fallback to browser language
    return detectBrowserLanguage();
}

// Language switcher functionality
let currentLanguage = localStorage.getItem('language') || null;

// Make setLanguage globally accessible
window.setLanguage = function(lang) {
    currentLanguage = lang;
    localStorage.setItem('language', lang);
    document.documentElement.lang = lang;
    
    const t = translations[lang];
    if (!t) return;
    
    // Update all elements with data-i18n attribute
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (t[key]) {
            element.textContent = t[key];
        }
    });
    
    // Update language switcher active state
    document.querySelectorAll('.lang-switcher button').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.lang === lang) {
            btn.classList.add('active');
        }
    });
};

// Initialize language on page load
document.addEventListener('DOMContentLoaded', async () => {
    // If no manual language selection, detect automatically
    if (!currentLanguage) {
        const detectedLang = await detectCountryAndLanguage();
        currentLanguage = detectedLang;
    }
    
    window.setLanguage(currentLanguage);
});

